<% if @run.errors.any? %>
  <div id="error_explanation">
    <h2>
      <%= pluralize(@run.errors.count, "error") %>
      prohibited this run from being saved:
    </h2>

    <ul>
    <% @run.errors.full_messages.each do |msg| %>
      <li><%= msg %></li>
    <% end %>
    </ul>
  </div>
<% end %>

<div class="container">
  <div class="feature"L>
    <h1>New Run Page</h1>

    <%= form_for @run do |f| %>

      <%= f.hidden_field :runner_id %>
      <%= f.label :course %>
      <%= f.text_field :course %>
      <br />
      <%= f.label :distance %>
      <%= f.text_field :distance %>
      <br />
      <%= f.label "Time (in minutes)" %>
      <%= f.text_field :time %>
      <br />
      <%= f.label :review %>
      <%= f.text_area :review %>
      <br />
      <%= f.label :rating %>
      <%= f.text_field :rating %>
      <br />
      <%= f.submit %>

    <% end %>

  </div>
</div>

<div id="postResult">

  <span id="runCourse"></span>
  <p id="runDistance"></span>
  <p id="runTime"></span>
  <p id="runReview"></span>
  <p id="runRating"></span>

</div>

<script type="text/javascript" charset="utf-8">

  class Run {
    constructor(course, distance, time, review, rating) {
      this.course = course;
      this.distance = distance;
      this.time = time;
      this.review = review;
      this.rating = rating;
    }
  }

  $(function() {
    $('form').submit(function(event) {
      event.preventDefault();

      var values = $(this).serialize();

      var posting = $.post('/runs', values);

      posting.done(function(data) {
        const course = data["course"];
        const distance = data["distance"];
        const time = data["time"];
        const review = data["review"];
        const rating = data["rating"];
        const run = new Run(course, distance, time, review, rating)

        $("#runCourse").text(run.course);
        $("#runDistance").text(run.distance);
        $("#runTime").text(run.time);
        $("#runReview").text(run.review);
        $("#runRating").text(run.rating);
      });
    });
  });

</script>
